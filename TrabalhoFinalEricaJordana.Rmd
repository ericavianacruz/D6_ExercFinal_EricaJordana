---
title: "Trabalho Final "
author: "Erica Jordana "
date: "18 de Outubro de 2018"
output: html_document
---

```{r setup, include=FALSE}
library("knitr")
knitr::opts_chunk$set(echo = TRUE)
##Instalando os pacotes necessários.

### Instalando Pacotes ## macetinhos
lista.de.pacotes = c("tidyverse","lubridate","janitor","readxl","stringr","repmis", "readr", "ggplot2") # escreva a lista de pacotes
novos.pacotes <- lista.de.pacotes[!(lista.de.pacotes %in%
                                      installed.packages()[,"Package"])]
if(length(novos.pacotes) > 0) {install.packages(novos.pacotes)}
lapply(lista.de.pacotes, require, character.only=T)
rm(lista.de.pacotes,novos.pacotes)
gc()
```

<center>
## Análise de Dados de atendimentos ao sistema Consumidor.gov em relação ao segmento de mercado de Transporte Aéreo.
<br>
</center>

<p style="text-align: justify;">Mais informa??es podem ser obtidas no website do Consumidor.gov] (http:\\www.consumidor.gov.br) .</p> 

<center>![CONSUMIDOR.GOV](https://www.consumidor.gov.br/resources/imagens/logo-nova-900.png) </center>

<p style="text-align: justify;"> </p>

#### Carregando o arquivo em mémoria e depois vamos usar o bind e apagar os arquivos temporários
```{r, warning=FALSE}
##carregando em memoria
consumidorgov1 <- read.csv ("F:/ENAP_Especializacao/D6_Analise_de_dados/D6_ExercFinal_EricaJordana/dados_brutos/2015_1.csv",head=TRUE, sep = ";")
consumidorgov2 <- read.csv ("F:/ENAP_Especializacao/D6_Analise_de_dados/D6_ExercFinal_EricaJordana/dados_brutos/2015_2.csv",head=TRUE, sep = ";")
consumidorgov3 <- read.csv ("F:/ENAP_Especializacao/D6_Analise_de_dados/D6_ExercFinal_EricaJordana/dados_brutos/2016_1.csv",head=TRUE, sep = ";")
consumidorgov4 <- read.csv ("F:/ENAP_Especializacao/D6_Analise_de_dados/D6_ExercFinal_EricaJordana/dados_brutos/2016_2.csv",head=TRUE, sep = ";")
consumidorgov5 <- read.csv ("F:/ENAP_Especializacao/D6_Analise_de_dados/D6_ExercFinal_EricaJordana/dados_brutos/2017_1.csv",head=TRUE, sep = ";")
consumidorgov6 <- read.csv ("F:/ENAP_Especializacao/D6_Analise_de_dados/D6_ExercFinal_EricaJordana/dados_brutos/2017_2.csv",head=TRUE, sep = ";")
consumidorgov181 <- read.csv ("F:/ENAP_Especializacao/D6_Analise_de_dados/D6_ExercFinal_EricaJordana/dados_brutos/2018-01.csv",head=TRUE, sep = ";")
consumidorgov182 <- read.csv ("F:/ENAP_Especializacao/D6_Analise_de_dados/D6_ExercFinal_EricaJordana/dados_brutos/2018-02.csv",head=TRUE, sep = ";")
consumidorgov183 <- read.csv ("F:/ENAP_Especializacao/D6_Analise_de_dados/D6_ExercFinal_EricaJordana/dados_brutos/2018-03.csv",head=TRUE, sep = ";")
consumidorgov184 <- read.csv ("F:/ENAP_Especializacao/D6_Analise_de_dados/D6_ExercFinal_EricaJordana/dados_brutos/2018-04.csv",head=TRUE, sep = ";")
consumidorgov185 <- read.csv ("F:/ENAP_Especializacao/D6_Analise_de_dados/D6_ExercFinal_EricaJordana/dados_brutos/2018-05.csv",head=TRUE, sep = ";")
consumidorgov186 <- read.csv ("F:/ENAP_Especializacao/D6_Analise_de_dados/D6_ExercFinal_EricaJordana/dados_brutos/2018-06.csv",head=TRUE, sep = ";")
consumidorgov187 <- read.csv ("F:/ENAP_Especializacao/D6_Analise_de_dados/D6_ExercFinal_EricaJordana/dados_brutos/2018-07.csv",head=TRUE, sep = ";")
consumidorgov188 <- read.csv ("F:/ENAP_Especializacao/D6_Analise_de_dados/D6_ExercFinal_EricaJordana/dados_brutos/2018-08.csv",head=TRUE, sep = ";")
consumidorgov189 <- read.csv ("F:/ENAP_Especializacao/D6_Analise_de_dados/D6_ExercFinal_EricaJordana/dados_brutos/2018-09.csv",head=TRUE, sep = ";")
##Usando bind para agrupar todos os arquivos em um único arquivo.

consumidorgov <- bind_rows(consumidorgov1,consumidorgov2,consumidorgov3,consumidorgov4,consumidorgov5,consumidorgov6,consumidorgov181,consumidorgov182,consumidorgov183,consumidorgov184,consumidorgov185,consumidorgov186,consumidorgov187,consumidorgov188,consumidorgov189)

##removendo arquivos temporários
rm(consumidorgov1,consumidorgov2,consumidorgov3,consumidorgov4,consumidorgov5,consumidorgov6,consumidorgov181,consumidorgov182,consumidorgov183,consumidorgov184,consumidorgov185,consumidorgov186,consumidorgov187,consumidorgov188,consumidorgov189)

```

#### Apresentando informações de cabeçalho dos dados
```{r, warning=FALSE}
head(consumidorgov)

```
### A plataforma Consumidor.gov 

<p style="text-align: justify;">O <b>Consumidor.gov.br</b> É um serviço público que permite a interlocução direta entre consumidores e empresas para solução alternativa de conflitos de consumo pela internet.</p>

<p style="text-align: justify;">Ele não substitui o serviço prestado pelos órgãos de Defesa do Consumidor, que continuam atendendo os consumidores normalmente por meio de seus canais tradicionais de atendimento.</p>

<p style="text-align: justify;">A principal inovação do Consumidor.gov.br está em possibilitar uma interlocução direta entre consumidores e empresas, em um ambiente totalmente público e transparente, dispensada a intervenção do Poder Público na tratativa individual.</p>

<p style="text-align: justify;">Em dezembro de 2016, a Agência Nacional de Aviação Civil – ANAC e a Secretaria Nacional do Consumidor – Senacon do Ministério da Justiça, assinaram o Acordo de Cooperação Técnica nº 2, pelo qual a ANAC aderiu à plataforma de solução alternativa de conflitos Consumidor.gov.br. Trata-se de um ambiente virtual ágil para a solução de problemas entre consumidores e empresas.</p>

<p style="text-align: justify;">O Consumidor.gov.br é gerido pela Senacon, em conjunto com outros órgãos públicos de defesa do consumidor. O uso da plataforma é recomendado pelo Poder Judiciário de 16 Estados como forma de promoção de conciliação e redução da judicialização. O sistema ainda foi reconhecido pelo Ministério da Transparência e Controladoria Geral da União como melhor serviço público digital do Governo Federal.</p>

<p style="text-align: justify;">Com a adesão da ANAC, a agência reguladora passa a realizar um monitoramento de maior qualidade sobre as reclamações de consumidores em relação ao serviço de transporte aéreo de passageiros.  A parceria visa otimizar a utilização de um canal público de solução alternativa de conflitos, propiciando resolução célere e segura de conflitos de consumo. A representatividade do transporte aéreo na plataforma em 2017 é de 2,51% das reclamações registradas, segundo divulgação da Senacon.</p>

####Limpando os dados das colunas usando o pacote janitor.
```{r, echo=TRUE}
consumidorgov <- consumidorgov %>% clean_names()
```

```{r, echo=TRUE}

names(consumidorgov)[10] <- "Area"
names(consumidorgov)[1] <- "Regiao"
names(consumidorgov)[5] <- "Faixa_Etaria"
names(consumidorgov)[6] <- "Data_Finalizacao"
names(consumidorgov)[17] <- "Situacao"
names(consumidorgov)[18] <- "Avaliacao_Reclamacao"
names(consumidorgov)[8] <- "Nome_Fantasia"
names(consumidorgov)[9] <- "Segmento_Mercado"

colnames(consumidorgov)
```

#### Qual a proporção de problemas por segmento usando tydeverse
```{r}
consumidorgov %>% ggplot (aes (x = Area, colour = Area, fill = Area)) +
  theme_minimal() +
  geom_bar(stat = 'count') + 
  scale_y_continuous(name = "" , breaks = c(0,2e+05,4e+05),labels=c('0','200 mil','400 mil')) +
  labs(title = "Quantidade de Reclamações por Área") +
  theme(axis.text.x = element_blank()) +
  theme(plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5))
```

#### Filter vamos trabalhar apenas com dados de Transporte Aéreo
```{r}
consumidoraereo <- consumidorgov %>% filter(Segmento_Mercado == "Transporte Aéreo")

### Tabela de Problemas
problemas <- consumidoraereo %>% count(Problema)
### Tabela de Empresas
empresas <- consumidoraereo %>% count(Nome_Fantasia)

##Como juntar os dados da Avianca?
empresas <- empresas %>% filter (Nome_Fantasia %in% c("Tam", "Gol Linhas Aéreas", "Latam Airlines (Tam)", "Azul Linhas Aéreas")) 
  
## Data atualizando
consumidoraereo <- consumidoraereo %>% mutate(Data_Finalizacao = dmy(Data_Finalizacao), ano = year(data_finalizacao))

## Ano das reclamaçoes 
ano_empresa <- consumidoraereo %>% count(Nome_Fantasia, ano)

```

#### Pizza por empresa, completar e melhorar
```{r}
ggplot (data = empresas, aes (x= "", y = n, fill = Nome_Fantasia))     +
    geom_bar (stat = "identity") +
    coord_polar("y", start = 0)
theme_minimal()

```

#### Pizza nome fantasia

#### GrÃ¡fico de barras tipo do problema

